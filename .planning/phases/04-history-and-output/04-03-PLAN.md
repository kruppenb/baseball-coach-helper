---
phase: 04-history-and-output
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/lineup/DugoutCard.tsx
  - src/components/lineup/DugoutCard.module.css
  - src/components/lineup/LineupPage.tsx
  - src/index.css
autonomous: false

must_haves:
  truths:
    - "User can print a single-page dugout card showing fielding grid and batting order"
    - "Dugout card uses HTML table for reliable cross-browser print rendering"
    - "Printed card is readable from a few feet away (13-14pt font, thick borders)"
    - "Only the dugout card is visible when printing (everything else hidden)"
  artifacts:
    - path: "src/components/lineup/DugoutCard.tsx"
      provides: "Print-optimized fielding grid table + batting order list"
      min_lines: 40
    - path: "src/components/lineup/DugoutCard.module.css"
      provides: "Print-specific CSS with @media print rules, @page landscape"
      contains: "@media print"
    - path: "src/index.css"
      provides: "Global print hide rules"
      contains: "@media print"
  key_links:
    - from: "src/components/lineup/LineupPage.tsx"
      to: "src/components/lineup/DugoutCard.tsx"
      via: "renders DugoutCard when lineup is selected"
      pattern: "DugoutCard"
    - from: "src/components/lineup/DugoutCard.tsx"
      to: "window.print"
      via: "Print button triggers window.print()"
      pattern: "window\\.print"
---

<objective>
Create a printable dugout card component showing the fielding grid and batting order in a format readable from a few feet away.

Purpose: Coaches print this card and hang it in the dugout during the game. It is the primary physical output of the entire app. This completes OUTP-01, OUTP-02, and OUTP-03.
Output: DugoutCard component with print-optimized HTML table, "Print Dugout Card" button on LineupPage, global @media print rules to hide non-card content.
</objective>

<execution_context>
@C:/Users/nicho/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/nicho/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-history-and-output/04-RESEARCH.md

@src/types/index.ts
@src/components/lineup/LineupPage.tsx
@src/components/lineup/LineupGrid.tsx
@src/index.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: DugoutCard component with print styles</name>
  <files>src/components/lineup/DugoutCard.tsx, src/components/lineup/DugoutCard.module.css, src/index.css</files>
  <action>
    Create src/components/lineup/DugoutCard.tsx:
    - Props: { lineup: Lineup; innings: number; players: Player[]; battingOrder: string[] | null }
    - Render a wrapper div with a data attribute `data-dugout-card` (used by global print CSS) and the CSS module class.
    - Header section: "Dugout Card" title and game date (new Date().toLocaleDateString()).
    - Fielding grid as an HTML `<table>` (NOT CSS Grid -- per research, tables are most reliable in print):
      - `<thead>`: corner cell (empty), then "Inn 1", "Inn 2", ... "Inn {innings}" column headers.
      - `<tbody>`: one row per position in POSITIONS order (P, C, 1B, 2B, 3B, SS, LF, CF, RF). First cell is position label. Remaining cells show player name for that position/inning.
      - Final row: "Bench" label + bench player names per inning (comma-separated).
    - Batting order section below the table:
      - Heading "Batting Order"
      - If battingOrder is provided and non-empty, render as a numbered list (ol) showing player names resolved from IDs.
      - If battingOrder is null, show "Not generated yet"
    - "Print Dugout Card" button at the bottom. OnClick calls `window.print()`. This button is hidden in print via CSS.

    Create src/components/lineup/DugoutCard.module.css:
    - Screen styles: card-like container with border, padding, margin-top. Table with basic borders for preview. Button styled prominently.
    - `.printButton`: display block, margin auto, padding, font-size. Hidden in print.
    - `@media print` block within the module:
      - `.printButton { display: none }` (hide the print button when printing)
      - `.card` styling: font-family Arial/Helvetica/sans-serif, color #000.
      - Table: width 100%, border-collapse collapse, table-layout fixed.
      - th/td: border 2px solid #000, padding 4pt 6pt, text-align center, font-size 13pt.
      - th: background #e0e0e0 with `-webkit-print-color-adjust: exact` and `print-color-adjust: exact`.
      - Batting order list: font-size 12pt, columns 2 (CSS multi-column) for compact layout.

    Update src/index.css -- add global @media print rules at the end:
    ```css
    @media print {
      body * {
        visibility: hidden;
      }
      [data-dugout-card],
      [data-dugout-card] * {
        visibility: visible;
      }
      [data-dugout-card] {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
      }
      @page {
        size: landscape;
        margin: 0.5in;
      }
    }
    ```
    Use `[data-dugout-card]` attribute selector (not class) so it works regardless of CSS module hash.
  </action>
  <verify>
    - `npx tsc --noEmit` compiles
    - Dev server: DugoutCard component renders with fielding table and batting order when lineup is selected
    - Print preview (Ctrl+P) shows only the dugout card, landscape, readable text
  </verify>
  <done>DugoutCard renders a print-optimized HTML table with fielding grid and batting order. Global print CSS hides everything except the card. Print button triggers window.print().</done>
</task>

<task type="auto">
  <name>Task 2: Wire DugoutCard into LineupPage</name>
  <files>src/components/lineup/LineupPage.tsx</files>
  <action>
    In LineupPage.tsx:
    - Import DugoutCard from './DugoutCard'.
    - Import useBattingOrder to access currentOrder for the batting order data.
    - After the existing `{selectedLineup && ...}` section that shows LineupGrid + FairnessSummary, and after the ValidationPanel, add:
      ```
      {selectedLineup && (
        <div className={styles.section}>
          <DugoutCard
            lineup={selectedLineup}
            innings={innings}
            players={players}
            battingOrder={battingOrderData}
          />
        </div>
      )}
      ```
    - Get battingOrderData from useBattingOrder's currentOrder.
    - The DugoutCard should appear below the BattingOrderSection so the coach can see and print the card after both lineup and batting order are set.

    Note: Place the DugoutCard render AFTER the BattingOrderSection div, still inside the main conditional for presentPlayers >= 9. The card only renders when selectedLineup exists.
  </action>
  <verify>
    - `npx tsc --noEmit` compiles
    - Dev server: After selecting a lineup, DugoutCard appears below the batting order section
    - Clicking "Print Dugout Card" opens print dialog with only the card visible
  </verify>
  <done>DugoutCard is rendered on LineupPage when a lineup is selected, showing both fielding grid and batting order with a working print button.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify print output</name>
  <files>n/a</files>
  <action>
    Human verification of print output quality. No automated action -- all implementation done in Tasks 1 and 2.
  </action>
  <verify>
    Print preview shows dugout card in landscape with readable text (13-14pt) and thick borders.
  </verify>
  <done>User confirms print output is acceptable for dugout use.</done>
  <what-built>Printable dugout card with fielding grid (HTML table) and batting order. Print button triggers window.print(). Global CSS hides everything except the card during print.</what-built>
  <how-to-verify>
    1. Start dev server: `npm run dev`
    2. Navigate to http://localhost:5180
    3. Ensure at least 9 players are present on Game Setup tab
    4. Go to Lineup tab, generate lineups, select one
    5. Generate a batting order in the Batting Order section
    6. Scroll down to see the Dugout Card section with fielding table and batting order
    7. Click "Print Dugout Card" button
    8. In print preview: verify ONLY the dugout card is visible (no header, tabs, other UI)
    9. Verify landscape orientation is suggested
    10. Verify text is large enough to read (13-14pt body, thick borders)
    11. Verify batting order appears as numbered list below the fielding grid
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues with the print layout</resume-signal>
</task>

</tasks>

<verification>
- DugoutCard component renders a fielding table with positions as rows and innings as columns
- Batting order displayed as numbered list on the card
- Print preview shows only the dugout card (everything else hidden)
- Text size 13-14pt, thick borders for readability
- @page landscape hint for print orientation
</verification>

<success_criteria>
- User can see a dugout card preview on the Lineup tab after selecting a lineup
- Clicking "Print Dugout Card" shows print dialog with only the card visible
- Printed output is readable from a few feet away in a dugout
- Batting order is displayed alongside fielding grid on the card
</success_criteria>

<output>
After completion, create `.planning/phases/04-history-and-output/04-03-SUMMARY.md`
</output>
