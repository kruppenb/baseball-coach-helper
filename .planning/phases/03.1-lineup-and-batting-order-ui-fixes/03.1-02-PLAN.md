---
phase: 03.1-lineup-and-batting-order-ui-fixes
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/lineup/FairnessSummary.tsx
  - src/components/lineup/FairnessSummary.module.css
  - src/components/lineup/LineupPage.tsx
autonomous: true

must_haves:
  truths:
    - "Coach can see each player's infield innings count on the selected lineup"
    - "Coach can see each player's bench innings count on the selected lineup"
    - "Fairness summary appears below the lineup grid when a lineup is selected"
  artifacts:
    - path: "src/components/lineup/FairnessSummary.tsx"
      provides: "Presentational fairness summary table component"
      contains: "FairnessSummary"
    - path: "src/components/lineup/FairnessSummary.module.css"
      provides: "Fairness summary table styles"
      contains: ".table"
    - path: "src/components/lineup/LineupPage.tsx"
      provides: "Page container that computes and passes fairness data"
      contains: "FairnessSummary"
  key_links:
    - from: "src/components/lineup/LineupPage.tsx"
      to: "FairnessSummary component"
      via: "renders FairnessSummary with computed data below LineupGrid"
      pattern: "FairnessSummary"
    - from: "FairnessSummary computation"
      to: "INFIELD_POSITIONS"
      via: "uses constant to count infield innings per player"
      pattern: "INFIELD_POSITIONS"
---

<objective>
Add a per-player fairness summary showing infield innings and bench innings counts below the lineup grid.

Purpose: Coaches need to validate at a glance that the lineup is fair -- specifically how many infield innings and bench innings each player gets. This was a pending todo from Phase 2 and surfaced again in Phase 3 UAT.

Output: FairnessSummary presentational component rendered below LineupGrid showing per-player infield and bench counts.
</objective>

<execution_context>
@C:/Users/nicho/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/nicho/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03.1-lineup-and-batting-order-ui-fixes/03.1-RESEARCH.md
@src/components/lineup/LineupGrid.tsx
@src/components/lineup/LineupGrid.module.css
@src/components/lineup/LineupPage.tsx
@src/components/lineup/LineupPage.module.css
@src/types/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FairnessSummary component with per-player infield and bench counts</name>
  <files>
    src/components/lineup/FairnessSummary.tsx
    src/components/lineup/FairnessSummary.module.css
  </files>
  <action>
Create a new pure presentational component `FairnessSummary` that displays per-player fairness stats.

FairnessSummary.tsx:
- Define a `PlayerFairness` interface: `{ playerId: string; name: string; infieldInnings: number; benchInnings: number }`
- Define `FairnessSummaryProps`: `{ summary: PlayerFairness[] }`
- The component receives pre-computed summary data (computation happens in parent)
- Render a compact table/list with columns: Player Name | Infield | Bench
- Use a simple HTML table for alignment:
  - `<table>` with header row: "Player", "Infield", "Bench"
  - One row per player with their name, infield count, bench count
  - Sort order: received order (parent controls sort)
- If summary is empty, return null
- Export the `PlayerFairness` interface so the parent can import it
- NO hooks -- this is a pure presentational component

FairnessSummary.module.css:
- `.wrapper`: margin-top using `var(--space-md)` for spacing below grid
- `.heading`: font-size `var(--font-size-base)`, font-weight 600, margin-bottom `var(--space-sm)`
- `.table`: width 100%, border-collapse collapse, font-size `var(--font-size-sm)`
- `.headerCell`: text-align left for name column, center for number columns, padding `var(--space-xs) var(--space-sm)`, border-bottom 2px solid `var(--color-border)`, font-weight 600, color `var(--color-text-muted)`
- `.cell`: padding `var(--space-xs) var(--space-sm)`, border-bottom 1px solid `var(--color-border)`, text-align matching header
- `.numberCell`: text-align center (for the infield/bench count columns)
- Use CSS custom properties from tokens.css exclusively (no hardcoded colors)
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm the component compiles.
Confirm the file exports FairnessSummary and PlayerFairness.
Confirm no hooks are imported.
  </verify>
  <done>
FairnessSummary component exists, is purely presentational, renders a table of player names with infield and bench inning counts. PlayerFairness interface is exported.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire FairnessSummary into LineupPage with computation logic</name>
  <files>
    src/components/lineup/LineupPage.tsx
  </files>
  <action>
In LineupPage.tsx:
- Import `FairnessSummary` and `PlayerFairness` from `./FairnessSummary`
- Import `INFIELD_POSITIONS` and `POSITIONS` from `../../types/index` (POSITIONS may already be imported via other components -- check)
- Add a `computeFairnessSummary` function (pure function, NOT a hook) either at module level or inline:
  - Parameters: `lineup: Lineup, innings: number, players: Player[]`
  - Returns: `PlayerFairness[]`
  - For each present player:
    - Count infield innings: iterate innings 1..N, check if player's ID appears as the value for any position in `INFIELD_POSITIONS` in that inning's assignment
    - Count bench innings: iterate innings 1..N, check if player's ID does NOT appear as the value for any position in `POSITIONS`
  - Return array sorted by player name (alphabetical) for consistent display
- In the JSX, render `<FairnessSummary>` immediately after the `<LineupGrid>` section (inside the same conditional `{selectedLineup && ...}` block):
  - Compute the summary by calling `computeFairnessSummary(selectedLineup, innings, players)`
  - Pass as `summary` prop
- The `players` variable is already available from `useRoster()` -- use it (includes all players, the computation function filters to present only)

Do NOT add hooks to LineupGrid. Do NOT modify LineupGrid at all -- the fairness summary is a sibling component composed by LineupPage.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm no type errors.
Run `npx vitest run` to confirm all tests pass.
Run dev server (`npx vite --port 5180`) and verify:
  1. Generate a lineup with 10+ players
  2. Select a lineup option
  3. Below the position grid, a "Player Summary" table appears
  4. Each present player shows their name, infield innings count, and bench innings count
  5. Counts are consistent with what the grid displays
  </verify>
  <done>
FairnessSummary renders below the lineup grid showing per-player infield and bench inning counts. Data is computed from the selected lineup. No hooks added to any presentational component. All tests pass.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with zero errors
2. `npx vitest run` passes all existing tests
3. FairnessSummary component exists and is purely presentational (no hooks)
4. LineupPage renders FairnessSummary below LineupGrid when a lineup is selected
5. Summary shows accurate infield and bench counts per player
6. No modifications to LineupGrid.tsx
</verification>

<success_criteria>
- Selecting a lineup shows a fairness summary table below the grid
- Each present player row shows: name, infield innings count, bench innings count
- Infield innings count includes P, C, 1B, 2B, 3B, SS positions
- Bench innings count reflects innings where player has no position assignment
- Component is purely presentational, computation happens in LineupPage
- TypeScript compiles cleanly, all tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/03.1-lineup-and-batting-order-ui-fixes/03.1-02-SUMMARY.md`
</output>
