---
phase: 01-foundation
plan: 03
type: execute
wave: 2
depends_on: ["01-01"]
files_modified:
  - src/components/game-setup/PlayerAttendance.tsx
  - src/components/game-setup/PlayerAttendance.module.css
  - src/components/game-setup/AttendanceList.tsx
  - src/components/game-setup/AttendanceList.module.css
  - src/components/game-setup/SettingsPanel.tsx
  - src/components/game-setup/SettingsPanel.module.css
  - src/components/game-setup/GameSetupPage.tsx
  - src/components/game-setup/GameSetupPage.module.css
  - src/hooks/useGameConfig.ts
  - src/components/app-shell/AppShell.tsx
autonomous: false

must_haves:
  truths:
    - "User can tap a player to toggle between present and absent"
    - "Absent players are visually dimmed with line-through"
    - "All players default to present"
    - "Present/absent count is visible (e.g. '10 of 12 present')"
    - "User can set innings to 5 or 6"
    - "Inning setting persists across page refresh"
    - "Inning config is in a settings area, not on the roster page"
    - "Game Setup tab shows attendance list and settings panel"
  artifacts:
    - path: "src/components/game-setup/PlayerAttendance.tsx"
      provides: "Single player attendance toggle with role=switch"
      exports: ["PlayerAttendance"]
    - path: "src/components/game-setup/AttendanceList.tsx"
      provides: "Full attendance list with present/absent counts"
      exports: ["AttendanceList"]
    - path: "src/components/game-setup/SettingsPanel.tsx"
      provides: "Inning count selector (5 or 6)"
      exports: ["SettingsPanel"]
    - path: "src/components/game-setup/GameSetupPage.tsx"
      provides: "Game Setup tab container"
      exports: ["GameSetupPage"]
    - path: "src/hooks/useGameConfig.ts"
      provides: "Game config persistence (innings setting)"
      exports: ["useGameConfig"]
  key_links:
    - from: "src/components/game-setup/GameSetupPage.tsx"
      to: "src/hooks/useRoster.ts"
      via: "reads roster for attendance list"
      pattern: "useRoster\\(\\)"
    - from: "src/components/game-setup/GameSetupPage.tsx"
      to: "src/hooks/useGameConfig.ts"
      via: "reads and writes inning config"
      pattern: "useGameConfig\\(\\)"
    - from: "src/hooks/useGameConfig.ts"
      to: "src/hooks/useLocalStorage.ts"
      via: "persists config via useLocalStorage"
      pattern: "useLocalStorage.*gameConfig"
    - from: "src/components/app-shell/AppShell.tsx"
      to: "src/components/game-setup/GameSetupPage.tsx"
      via: "renders GameSetupPage in game-setup tab panel"
      pattern: "<GameSetupPage"
---

<objective>
Build the Game Setup page with attendance toggling (mark present/absent) and inning configuration (5 or 6), completing all Phase 1 requirements.

Purpose: Deliver ROST-05 (configure innings) and ROST-06 (mark absent) -- the game-day setup features that prepare the roster for lineup generation in Phase 2.
Output: Fully functional Game Setup tab where coaches can mark attendance and configure innings, plus a visual verification checkpoint to confirm the entire Phase 1 UI works correctly.
</objective>

<execution_context>
@C:/Users/nicho/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/nicho/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@C:/repos/baseball-coach-helper/.planning/PROJECT.md
@C:/repos/baseball-coach-helper/.planning/ROADMAP.md
@C:/repos/baseball-coach-helper/.planning/phases/01-foundation/01-CONTEXT.md
@C:/repos/baseball-coach-helper/.planning/phases/01-foundation/01-RESEARCH.md
@C:/repos/baseball-coach-helper/.planning/phases/01-foundation/01-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build Game Setup components and integrate into AppShell</name>
  <files>
    src/hooks/useGameConfig.ts
    src/components/game-setup/PlayerAttendance.tsx
    src/components/game-setup/PlayerAttendance.module.css
    src/components/game-setup/AttendanceList.tsx
    src/components/game-setup/AttendanceList.module.css
    src/components/game-setup/SettingsPanel.tsx
    src/components/game-setup/SettingsPanel.module.css
    src/components/game-setup/GameSetupPage.tsx
    src/components/game-setup/GameSetupPage.module.css
    src/components/app-shell/AppShell.tsx
  </files>
  <action>
    1. Create `src/hooks/useGameConfig.ts`:
       - Uses `useLocalStorage<GameConfig>('gameConfig', { innings: 6 })` for persistence
       - Returns `{ config, setInnings: (value: 5 | 6) => void }`
       - `setInnings` updates the innings field in the config object
       - Default is 6 innings per user decision (persistent setting, set once, stays until changed)

    2. Create `src/components/game-setup/PlayerAttendance.tsx`:
       - Props: `player: Player`, `onToggle: () => void`
       - Render as a `<button>` element (entire row is tappable, per user decision "tap a player to toggle")
       - `role="switch"`, `aria-checked={player.isPresent}`, `aria-label="{name}: {present|absent}"`
       - Display player name on the left, "Present" or "Absent" status text on the right
       - When absent: apply an `.absent` CSS class that dims the row and adds line-through
       Follow the pattern from 01-RESEARCH.md "Attendance Toggle" exactly.

    3. Create `src/components/game-setup/PlayerAttendance.module.css`:
       - Row button: flex layout, justify-content space-between, width 100%, min-height var(--min-tap-size), padding var(--space-md) var(--space-lg), background var(--color-surface), border 1px solid var(--color-border), border-radius var(--radius-sm), cursor pointer, font-size var(--font-size-lg), color var(--color-text)
       - .absent class: opacity 0.45, text-decoration line-through
       - :active state: background var(--color-surface-hover)
       - Status text: font-size var(--font-size-sm), color var(--color-text-muted)
       Follow the CSS from 01-RESEARCH.md exactly.

    4. Create `src/components/game-setup/AttendanceList.tsx`:
       - Props: `players: Player[]`, `onToggle: (id: string) => void`
       - Display attendance summary at top: "{presentCount} of {totalCount} present" (e.g., "10 of 12 present")
       - If no players: show message "No players on roster. Add players in the Roster tab first."
       - Map over players, render PlayerAttendance for each, use player.id as key
       - Players shown in same alphabetical order as roster (already sorted by useRoster)

    5. Create `src/components/game-setup/AttendanceList.module.css`:
       - Summary: color var(--color-text-muted), font-size var(--font-size-sm), font-weight 500, margin-bottom var(--space-md)
       - Empty state: same styling as roster empty state
       - List: flex column, gap var(--space-xs)

    6. Create `src/components/game-setup/SettingsPanel.tsx`:
       - Props: `innings: 5 | 6`, `onInningsChange: (value: 5 | 6) => void`
       - Render a "Settings" heading (h3)
       - Render a labeled select dropdown for innings: "Innings per game" label, `<select>` with options "5 innings" and "6 innings"
       - Use proper `<label htmlFor>` and matching `id` on the select
       Follow the pattern from 01-RESEARCH.md "Inning Configuration" exactly.

    7. Create `src/components/game-setup/SettingsPanel.module.css`:
       - Settings container: padding var(--space-lg), background var(--color-surface), border-radius var(--radius-md), border 1px solid var(--color-border)
       - Title: font-size var(--font-size-lg), font-weight 600, margin 0 0 var(--space-md)
       - Setting row: flex layout, justify-content space-between, align-items center
       - Label: font-size var(--font-size-base)
       - Select: min-height var(--min-tap-size), padding var(--space-sm) var(--space-md), font-size var(--font-size-base), border-radius var(--radius-sm), border 1px solid var(--color-border)

    8. Create `src/components/game-setup/GameSetupPage.tsx`:
       - Call `useRoster()` directly for player data and togglePresent (not prop-drilled)
       - Call `useGameConfig()` for innings setting
       - Page title: "Game Setup" as h2
       - Render AttendanceList first (players + toggle), then SettingsPanel below
       - Pass appropriate props from hooks to child components

    9. Create `src/components/game-setup/GameSetupPage.module.css`:
       - Page container: flex column, gap var(--space-xl)
       - Title: font-size var(--font-size-xl), font-weight 600, margin 0
       - Sections separated by generous spacing for readability

    10. Update `src/components/app-shell/AppShell.tsx`:
        - Import GameSetupPage
        - Replace the game-setup tab placeholder text with `<GameSetupPage />`
        - Both tabs now render real page components
  </action>
  <verify>
    - `npm run dev` loads the app, Game Setup tab shows attendance list and settings
    - Add a few players in Roster tab, switch to Game Setup: all players appear as "Present"
    - Tap a player in Game Setup: toggles to "Absent" with dimmed/line-through styling
    - Tap again: toggles back to "Present"
    - Attendance summary updates (e.g., "2 of 3 present")
    - Change innings to 5: setting persists after page refresh
    - Switch tabs and back: attendance state preserved (stored in useRoster via localStorage)
    - Empty roster in Game Setup shows appropriate message
    - `npm run build` passes with zero errors
  </verify>
  <done>
    Game Setup tab fully functional with attendance toggling (tap to mark absent/present with visual dimming) and inning configuration (5 or 6, persistent). Attendance summary shows present count. Settings panel separated from attendance list. Requirements ROST-05 and ROST-06 are complete.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify complete Phase 1 UI</name>
  <files>none</files>
  <action>
    Human verification checkpoint. No automated action -- all implementation completed in Task 1. Present the verification checklist to the user and wait for approval.
  </action>
  <verify>User confirms approval or provides issues to fix.</verify>
  <done>User types "approved" confirming all Phase 1 features work correctly.</done>
  <what-built>
    Complete Phase 1 Foundation: Roster management (add/edit/remove players with quick-add, inline edit, delete confirmation, alphabetical sort, player count, duplicate detection, auto-capitalization) and Game Setup (attendance toggling with visual dimming, inning configuration with persistence). Two-tab app shell with accessible navigation.
  </what-built>
  <how-to-verify>
    Run `npm run dev` and open the app in a browser. Test the following:

    **Roster Tab:**
    1. Add 3-4 players (e.g., "Jake R", "Sarah M", "Alex B", "Mike T") using Enter key
    2. Verify alphabetical sorting and player count (e.g., "4 players")
    3. Try adding "jake r" again -- should show duplicate warning
    4. Click a player name, edit it, press Enter -- verify name updates and re-sorts
    5. Click a player name, edit it, press Escape -- verify name reverts
    6. Click "Remove" on a player -- verify Confirm/Cancel appears
    7. Click "Cancel" -- verify nothing happens
    8. Click "Remove" then "Confirm" -- verify player is removed and count updates

    **Game Setup Tab:**
    9. Switch to Game Setup tab -- all players should appear as "Present"
    10. Tap a player -- should toggle to "Absent" (dimmed, line-through)
    11. Verify attendance summary (e.g., "3 of 4 present")
    12. Change innings to 5 -- verify dropdown updates
    13. Refresh the page -- verify roster, attendance, and innings all persist

    **Navigation:**
    14. Use keyboard arrow keys to switch between tabs
    15. Verify active tab has a visual indicator

    **Mobile feel:**
    16. Resize browser to phone width (~375px) -- verify layout adapts and buttons are tappable
  </how-to-verify>
  <resume-signal>Type "approved" to complete Phase 1, or describe any issues to fix</resume-signal>
</task>

</tasks>

<verification>
- All four Phase 1 requirements met:
  - ROST-01: Add players with first name and last initial
  - ROST-02: Edit and remove players from roster
  - ROST-05: Configure number of innings (5 or 6)
  - ROST-06: Mark players as absent for current game
- All locked user decisions implemented exactly:
  - Quick-add inline with Enter
  - Single input field for full name
  - Auto-capitalize names, warn on duplicates
  - Click to edit inline, alphabetical sort, delete confirmation, player count
  - Tap to toggle present/absent, absent dimmed
  - Everyone defaults present
  - Inning config persistent, in settings area not roster
  - Tabbed navigation: Roster | Game Setup
  - Clean, minimal, high contrast, large tap targets
- Data persists in localStorage
- No console errors
</verification>

<success_criteria>
- ROST-05: Inning count (5 or 6) is configurable and persistent
- ROST-06: Coach can mark players absent by tapping, absent players are visually dimmed
- All Phase 1 success criteria from ROADMAP.md are met
- User approves the UI in the checkpoint
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-03-SUMMARY.md`
</output>
