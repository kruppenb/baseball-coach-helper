---
phase: 14-responsive-desktop-layout
plan: 02
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - src/components/game-day/GameDayDesktop.tsx
  - src/components/game-day/GameDayDesktop.module.css
  - src/components/app-shell/AppShell.tsx
  - src/components/app-shell/AppShell.module.css
  - src/components/game-day/StepperHeader.module.css

autonomous: false

must_haves:
  truths:
    - "On a desktop-width browser (>=900px), all 4 game-day sections are visible simultaneously without scrolling between steps"
    - "On a phone-width browser (<900px), the existing stepper flow works exactly as before"
    - "Resizing between phone and desktop widths transitions fluidly with no horizontal scrollbar"
    - "Sticky bottom bar with Generate and Print buttons is always visible on desktop without scrolling"
    - "StepperHeader is hidden on desktop"
    - "Generate button generates lineup and batting order, Print button triggers browser print"
  artifacts:
    - path: "src/components/app-shell/AppShell.tsx"
      provides: "Responsive switching between desktop and mobile layouts"
      contains: "useMediaQuery"
    - path: "src/components/game-day/GameDayDesktop.tsx"
      provides: "Desktop layout with sticky action bar"
      contains: "stickyBar"
  key_links:
    - from: "src/components/app-shell/AppShell.tsx"
      to: "src/hooks/useMediaQuery.ts"
      via: "hook call to determine layout"
      pattern: "useMediaQuery.*900"
    - from: "src/components/app-shell/AppShell.tsx"
      to: "src/components/game-day/GameDayDesktop.tsx"
      via: "conditional render on desktop"
      pattern: "isDesktop.*GameDayDesktop"
    - from: "src/components/app-shell/AppShell.tsx"
      to: "src/components/game-day/GameDayStepper.tsx"
      via: "conditional render on mobile"
      pattern: "!isDesktop.*GameDayStepper"
---

<objective>
Wire the desktop/mobile responsive switching, add the sticky action bar to the desktop layout, and verify both layouts work correctly.

Purpose: Complete the responsive experience — desktop users see all sections at once with persistent action buttons, mobile users keep the familiar stepper.
Output: Fully functional responsive game-day flow with sticky action bar on desktop.
</objective>

<execution_context>
@C:/Users/nicho/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/nicho/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-responsive-desktop-layout/14-CONTEXT.md
@.planning/phases/14-responsive-desktop-layout/14-01-SUMMARY.md

@src/components/app-shell/AppShell.tsx
@src/components/app-shell/AppShell.module.css
@src/components/game-day/GameDayStepper.tsx
@src/components/game-day/GameDayDesktop.tsx
@src/components/game-day/GameDayDesktop.module.css
@src/hooks/useMediaQuery.ts
@src/index.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire responsive switching and add sticky action bar</name>
  <files>
    src/components/app-shell/AppShell.tsx
    src/components/app-shell/AppShell.module.css
    src/components/game-day/GameDayDesktop.tsx
    src/components/game-day/GameDayDesktop.module.css
    src/components/game-day/StepperHeader.module.css
  </files>
  <action>
    **1. Update AppShell.tsx to switch layouts responsively:**

    - Import `useMediaQuery` from `../../hooks/useMediaQuery`
    - Import `GameDayDesktop` from `../game-day/GameDayDesktop`
    - Call `const isDesktop = useMediaQuery('(min-width: 900px)')`
    - In the game-day tab panel: render `<GameDayDesktop />` when `isDesktop` is true, render `<GameDayStepper />` when false
    - The Settings tab remains unchanged regardless of viewport

    **2. Add sticky action bar to GameDayDesktop:**

    Add a sticky bottom action bar to the `GameDayDesktop` component. This bar sits at the bottom of the viewport (above the tab bar) and contains two buttons: Generate Lineup and Print Dugout Card.

    In `GameDayDesktop.tsx`:
    - Add a `<div className={styles.stickyBar}>` at the bottom of the component (after the columns div, inside the desktop wrapper)
    - Generate button: calls the lineup `generate()` function and auto-generates batting order (same logic as ReviewStep's auto-generate). Disabled when `presentCount < 9` (not enough players). Label says "Generate Lineup" if no lineup exists, "Regenerate" if one does.
    - Print button: calls `window.print()`. Disabled when no lineup/batting order exists (nothing to print). Label says "Print Dugout Card".
    - Between the two buttons, show a small status area for generation errors or success messages.

    In `GameDayDesktop.module.css`:
    - `.stickyBar` — `position: sticky`, `bottom: 0`, `background: var(--color-bg)`, `border-top: 1px solid var(--color-border)`, `padding: var(--space-sm) var(--space-md)`, `display: flex`, `align-items: center`, `gap: var(--space-md)`, `z-index: 10`, `box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.05)`
    - `.generateBtn` — primary button style (blue background, white text, rounded)
    - `.printBtn` — secondary/outline button style (border, no fill)
    - `.statusText` — flex: 1, small text for status messages
    - Both buttons: `white-space: nowrap`, reasonable min-width so they don't shrink

    **3. Update AppShell.module.css for desktop:**

    - On desktop (`@media (min-width: 900px)`), remove `padding-bottom: 60px` from `.content` — the sticky bar handles its own spacing. Actually keep some bottom padding for the tab bar (the TabBar is still shown on desktop). Set `padding-bottom: 56px` on desktop to account for tab bar height.
    - Ensure `.content` has `overflow-y: visible` on desktop (not `auto`) so the page scrolls naturally as a whole document. The current `overflow-y: auto` creates a scrolling container which would prevent `position: sticky` from working on the action bar. On desktop, change to `overflow-y: visible` or remove the overflow property.

    **4. Handle the DugoutCard for print:**

    The Print button triggers `window.print()`. The existing `@media print` styles in `index.css` already handle hiding everything except `[data-dugout-card]`. However, GameDayDesktop needs to render a DugoutCard somewhere (hidden on screen, visible on print). Add a hidden DugoutCard at the bottom of the component:
    ```tsx
    {editor.lineup && editor.battingOrder && (
      <DugoutCard
        lineup={editor.lineup}
        innings={innings}
        players={players}
        battingOrder={editor.battingOrder}
      />
    )}
    ```
    The DugoutCard already has `data-dugout-card` attribute and the print CSS handles visibility. It should be rendered but visually part of the flow (the print CSS will isolate it).

    **5. Also handle finalize/save on print (preparation for Phase 15):**

    For now, do NOT auto-save on print (that's Phase 15 GFLW-03). But DO render the DugoutCard with the current editor state (not from history) so the coach can print the in-progress lineup. The existing Finalize button from ReviewStep is NOT needed on desktop per the decisions (no separate Review step on desktop). The finalize logic will be added in Phase 15 with print-as-save.

    However, the desktop layout should still show the DugoutCard inline (not hidden) if the coach wants to preview. Actually, the DugoutCard is only for printing — on the desktop the lineup grid IS the preview. Keep DugoutCard rendering for print only. It will naturally be hidden by `[data-dugout-card]` print CSS.

    **6. Ensure StepperHeader is hidden on desktop:**

    The StepperHeader is only inside GameDayStepper, which is not rendered on desktop. So it's automatically hidden. No CSS changes needed for StepperHeader itself. But verify that GameDayStepper is truly not rendered when `isDesktop` is true.

    Remove `src/components/game-day/StepperHeader.module.css` from the files_modified list — no changes needed there. (Keeping it in the plan frontmatter just in case, but likely no changes.)
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - `npm run build` passes
    - AppShell.tsx imports useMediaQuery and conditionally renders GameDayDesktop vs GameDayStepper
    - GameDayDesktop has sticky action bar with Generate and Print buttons
    - AppShell.module.css has desktop media query adjustments
  </verify>
  <done>
    AppShell responsively switches between GameDayDesktop (>=900px) and GameDayStepper (<900px). Desktop layout has a sticky bottom action bar with Generate and Print buttons. DugoutCard is rendered for print functionality. No horizontal scrollbar at any width.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify responsive desktop and mobile layouts</name>
  <files>n/a</files>
  <action>
    Human verification checkpoint. What was built: Responsive game-day layout that shows all sections simultaneously on desktop and preserves the stepper flow on mobile.

    How to verify:
    1. Run `npm run dev` and open http://localhost:5180 in a desktop browser (window wider than 900px)
    2. **Desktop layout check:**
       - Verify you see two columns: left has Attendance + P/C, right has Lineup + Batting Order
       - Verify cards have subtle shadows and rounded corners
       - Verify section labels are small, muted, uppercase
       - Verify the right column is wider than the left (~40/60 split)
       - Verify the sticky bar at the bottom has Generate and Print buttons
       - Verify no StepperHeader (numbered step indicators) is visible
    3. **Desktop interaction check:**
       - Mark 9+ players present in Attendance card
       - Select pitcher(s) and catcher(s) in P/C card
       - Click Generate in the sticky bar — lineup grid and batting order should populate in right column
       - Change attendance (toggle a player) — verify stale warning banner appears on right column
       - Click Print — verify browser print dialog opens with dugout card
    4. **Mobile layout check:**
       - Resize browser window to below 900px width (or use DevTools mobile view)
       - Verify the familiar stepper flow appears (Attend → P/C → Review → Print with numbered steps)
       - Verify the stepper works exactly as before (Next buttons, step progression)
    5. **Transition check:**
       - Slowly resize from wide to narrow and back
       - Verify no horizontal scrollbar appears at any width
       - Verify transition is fluid (no jarring layout jumps)
    6. **Scroll check:**
       - On desktop with many players, verify the page scrolls as a whole (no nested scrollbars in columns or cards)

    Resume signal: Type "approved" if both layouts work correctly, or describe any issues found.
  </action>
  <verify>Human confirms both desktop and mobile layouts work correctly</verify>
  <done>User has approved the responsive layout implementation</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` — no type errors
2. `npm run build` — build succeeds
3. Desktop (>=900px): 2-column layout with all 4 sections visible, sticky action bar
4. Mobile (<900px): Stepper flow unchanged (Attend → P/C → Review → Print)
5. No horizontal scrollbar at any viewport width
6. Cards have shadows, rounded corners, compact spacing
7. Stale warning appears when inputs change after generation
8. Generate button works from sticky bar
9. Print button opens browser print dialog with DugoutCard
</verification>

<success_criteria>
- DESK-01: All game-day sections visible simultaneously on desktop — PASS
- DESK-02: Left column = attendance + P/C, right column = lineup + batting order — PASS
- DESK-03: Mobile stepper flow unchanged — PASS
- DESK-04: Fluid transition between widths, no horizontal scrollbar — PASS
- Sticky bottom bar with Generate and Print always accessible — PASS
- Stale warning on right column when inputs change post-generation — PASS
</success_criteria>

<output>
After completion, create `.planning/phases/14-responsive-desktop-layout/14-02-SUMMARY.md`
</output>
