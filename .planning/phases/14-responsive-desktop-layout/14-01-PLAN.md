---
phase: 14-responsive-desktop-layout
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/hooks/useMediaQuery.ts
  - src/styles/tokens.css
  - src/components/app-shell/AppShell.module.css
  - src/components/game-day/GameDayDesktop.tsx
  - src/components/game-day/GameDayDesktop.module.css

autonomous: true

must_haves:
  truths:
    - "A useMediaQuery hook exists and returns true/false based on a CSS media query string"
    - "A desktop breakpoint CSS custom property is defined in the design tokens"
    - "AppShell max-width is 600px on mobile and unconstrained on desktop"
    - "GameDayDesktop component renders 4 sections in 2-column card layout on wide screens"
    - "Left column contains attendance and P/C assignment, right column contains lineup grid and batting order"
    - "Cards have subtle shadows and rounded corners per user decision"
    - "Right column is wider than left column (roughly 40/60 split)"
    - "Cards grow to natural height with no internal scrolling"
    - "Page scrolls as whole document, no nested scrollbars"
  artifacts:
    - path: "src/hooks/useMediaQuery.ts"
      provides: "Responsive media query hook"
      exports: ["useMediaQuery"]
    - path: "src/components/game-day/GameDayDesktop.tsx"
      provides: "Desktop 2-column game-day layout"
      exports: ["GameDayDesktop"]
    - path: "src/components/game-day/GameDayDesktop.module.css"
      provides: "Desktop layout styles with card presentation"
  key_links:
    - from: "src/hooks/useMediaQuery.ts"
      to: "window.matchMedia"
      via: "addEventListener for media query changes"
      pattern: "matchMedia.*addEventListener"
    - from: "src/components/game-day/GameDayDesktop.tsx"
      to: "src/components/game-setup/AttendanceList.tsx"
      via: "import and render in left column"
      pattern: "AttendanceList"
    - from: "src/components/game-day/GameDayDesktop.tsx"
      to: "src/components/lineup/DraggableLineupGrid.tsx"
      via: "import and render in right column"
      pattern: "DraggableLineupGrid"
---

<objective>
Create the responsive infrastructure (media query hook, breakpoint tokens, responsive AppShell) and the desktop 2-column game-day layout component with card presentation.

Purpose: Establish the foundation for showing all game-day sections simultaneously on wide screens while keeping the mobile shell constrained.
Output: useMediaQuery hook, updated tokens and AppShell, and a GameDayDesktop component with 4 sections in 2-column card layout.
</objective>

<execution_context>
@C:/Users/nicho/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/nicho/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-responsive-desktop-layout/14-CONTEXT.md

@src/styles/tokens.css
@src/components/app-shell/AppShell.tsx
@src/components/app-shell/AppShell.module.css
@src/components/game-day/GameDayStepper.tsx
@src/components/game-day/steps/AttendanceStep.tsx
@src/components/game-day/steps/PCAssignmentStep.tsx
@src/components/game-day/steps/ReviewStep.tsx
@src/components/game-day/steps/PrintStep.tsx
@src/components/game-setup/AttendanceList.tsx
@src/components/lineup/DraggableLineupGrid.tsx
@src/components/batting-order/SortableBattingOrder.tsx
@src/hooks/useLineup.ts
@src/hooks/useRoster.ts
@src/hooks/useStepperState.ts
@src/types/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add responsive infrastructure</name>
  <files>
    src/hooks/useMediaQuery.ts
    src/styles/tokens.css
    src/components/app-shell/AppShell.module.css
  </files>
  <action>
    1. Create `src/hooks/useMediaQuery.ts`:
       - Export a `useMediaQuery(query: string): boolean` hook
       - Uses `window.matchMedia(query)` to evaluate the media query
       - Listens for changes via `addEventListener('change', ...)` and updates state
       - Handles SSR/no-window gracefully (returns false)
       - Returns current match state as boolean
       - Cleans up listener on unmount

    2. Update `src/styles/tokens.css`:
       - Add `--breakpoint-desktop: 900px;` to the `:root` block (this is a reasonable threshold — above tablet portrait, below typical laptop)
       - Add `--shadow-card: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);` for card shadows per user decision (subtle)

    3. Update `src/components/app-shell/AppShell.module.css`:
       - Keep `max-width: 600px` as the default (mobile)
       - Add a `@media (min-width: 900px)` rule that sets `max-width: 1200px` on `.shell`
       - This allows the desktop layout to spread wider while still being centered
       - Keep `padding-bottom: 60px` on `.content` for the tab bar clearance
  </action>
  <verify>
    - `npx tsc --noEmit` passes (no type errors)
    - `src/hooks/useMediaQuery.ts` exports `useMediaQuery`
    - `src/styles/tokens.css` contains `--breakpoint-desktop` and `--shadow-card`
    - `src/components/app-shell/AppShell.module.css` has `@media (min-width: 900px)` rule
  </verify>
  <done>
    useMediaQuery hook exists and works. AppShell is responsive: 600px max on mobile, 1200px max on desktop. Design tokens include desktop breakpoint and card shadow values.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create GameDayDesktop 2-column layout component</name>
  <files>
    src/components/game-day/GameDayDesktop.tsx
    src/components/game-day/GameDayDesktop.module.css
  </files>
  <action>
    Create `src/components/game-day/GameDayDesktop.tsx`:

    This component shows ALL game-day sections simultaneously in a 2-column card layout. It reuses the same hooks and inner components that the step components use, but without step navigation.

    **Component structure:**
    ```
    <div className={styles.desktop}>
      <div className={styles.columns}>
        <div className={styles.leftColumn}>
          <Card label="Attendance">
            <AttendanceList players={players} onToggle={togglePresent} />
            <p>{presentCount} of {players.length} present</p>
          </Card>
          <Card label="Pitcher & Catcher">
            [P/C dropdowns + history table — extract the JSX from PCAssignmentStep's render]
          </Card>
        </div>
        <div className={styles.rightColumn}>
          {staleWarning && <StaleWarningBanner />}
          <Card label="Lineup">
            [DraggableLineupGrid + FairnessScoreCard + FairnessSummary + ValidationPanel]
          </Card>
          <Card label="Batting Order">
            [SortableBattingOrder + previous game comparison]
          </Card>
        </div>
      </div>
    </div>
    ```

    **Card wrapper:** Create an inline `Card` component within the file (not a separate file — it's simple):
    ```tsx
    function Card({ label, children }: { label: string; children: React.ReactNode }) {
      return (
        <section className={styles.card}>
          <h3 className={styles.cardLabel}>{label}</h3>
          {children}
        </section>
      );
    }
    ```

    **Hooks used (same as step components):**
    - `useRoster()` for players, presentCount, togglePresent
    - `useLineup()` for pitcher/catcher assignments, generate, generatedLineups, selectedLineup, presentPlayers, innings
    - `useLineupEditor()` for DnD lineup editing + validation
    - `useBattingOrder()` for batting order
    - `useGameHistory()` for history, finalizeGame
    - `useGameConfig()` for config

    **P/C section:** Replicate the P/C assignment logic from `PCAssignmentStep` — the slot selection state (selectedPitchers, selectedCatchers), distribution functions, and P/C history table. Import `computeRecentPCHistory` from `../../../logic/game-history`. Copy the helper functions `distributeAcrossInnings` and `slotsFromAssignments` from PCAssignmentStep (or import them if they get extracted — but for this plan, just inline them since they're small utility functions).

    **Lineup section:** Auto-generate on first render if no lineups exist (same pattern as ReviewStep). Show DraggableLineupGrid, FairnessScoreCard, FairnessSummary, ValidationPanel. Include the regenerate button within the card.

    **Batting order section:** Show SortableBattingOrder with reorder capability. Show previous game comparison if history exists (same as ReviewStep).

    **Stale warning:** When attendance or P/C changes after lineup has been generated, show a warning banner at the top of the right column. Track whether inputs changed after generation using a ref or state flag. The banner says "Attendance or P/C assignments changed since lineup was generated. Consider regenerating." with a Dismiss button. Style with the existing `--color-warning-bg` and `--color-warning` tokens.

    **Claude's discretion decisions:**
    - All sections editable at once (free-form, not locked/grayed) — this is simpler and the coach knows their workflow
    - Breakpoint: 900px (`--breakpoint-desktop`) — standard tablet landscape threshold
    - Tablet behavior: At 768-899px, still show mobile stepper (tablet portrait is narrow enough for stepper)

    Create `src/components/game-day/GameDayDesktop.module.css`:
    - `.desktop` — full width container
    - `.columns` — CSS Grid with `grid-template-columns: 2fr 3fr` (40/60 split per user decision), gap of `var(--space-md)` (compact spacing per user decision)
    - `.leftColumn`, `.rightColumn` — flex column with `gap: var(--space-md)`
    - `.card` — `background: var(--color-bg)`, `border-radius: var(--radius-md)` (8px), `box-shadow: var(--shadow-card)`, `padding: var(--space-md)` (compact)
    - `.cardLabel` — `font-size: var(--font-size-sm)`, `color: var(--color-text-muted)`, `font-weight: 600`, `margin: 0 0 var(--space-sm)`, `text-transform: uppercase`, `letter-spacing: 0.05em` — subtle/muted per user decision
    - `.staleWarning` — same styling pattern as GameDayStepper's stale warning but positioned at top of right column
    - No internal scroll styles — cards grow naturally, page scrolls

    **Important:** Do NOT add the sticky action bar in this task — that comes in Plan 02. This task focuses on the card layout and section content only.
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - `src/components/game-day/GameDayDesktop.tsx` exports `GameDayDesktop`
    - Component imports and uses: AttendanceList, DraggableLineupGrid, SortableBattingOrder, FairnessScoreCard, FairnessSummary, ValidationPanel
    - CSS file has `.columns` with `grid-template-columns: 2fr 3fr`
    - CSS file has `.card` with `box-shadow` and `border-radius`
  </verify>
  <done>
    GameDayDesktop component exists, rendering 4 sections in 2-column card layout. Left column has Attendance + P/C, right column has Lineup + Batting Order. Cards have subtle shadows and rounded corners. Stale warning banner appears on right column when inputs change after generation.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` — no type errors across entire project
2. `npm run build` — build succeeds
3. All new files exist: useMediaQuery.ts, GameDayDesktop.tsx, GameDayDesktop.module.css
4. AppShell.module.css has responsive max-width
5. tokens.css has --breakpoint-desktop and --shadow-card
</verification>

<success_criteria>
- useMediaQuery hook works and is type-safe
- AppShell switches between 600px (mobile) and 1200px (desktop) max-width
- GameDayDesktop renders all 4 sections in 2-column card layout with 40/60 split
- Cards have subtle shadows, rounded corners, compact spacing
- Section labels are subtle/muted (uppercase, small, muted color)
- Stale warning banner shows when inputs change post-generation
- No nested scrollbars — page scrolls as whole document
</success_criteria>

<output>
After completion, create `.planning/phases/14-responsive-desktop-layout/14-01-SUMMARY.md`
</output>
